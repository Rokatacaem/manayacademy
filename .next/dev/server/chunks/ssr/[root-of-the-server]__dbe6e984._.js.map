{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/rokat/OneDrive/Proyectos/ManayAcademy/src/app/tenant/%5Bslug%5D/courses/%5BcourseSlug%5D/%5BlessonSlug%5D/page.tsx"],"sourcesContent":["import { prisma } from '@/lib/prisma';\r\nimport { notFound } from 'next/navigation';\r\n\r\nexport default async function LessonPage({\r\n    params\r\n}: {\r\n    params: Promise<{ slug: string, courseSlug: string, lessonSlug: string }>\r\n}) {\r\n    const resolvedParams = await params;\r\n    const { slug, courseSlug, lessonSlug } = resolvedParams;\r\n\r\n    const tenant = await prisma.tenant.findUnique({ where: { slug } });\r\n    if (!tenant) notFound();\r\n\r\n    // Verify Course exists in Tenant\r\n    const course = await prisma.course.findUnique({\r\n        where: {\r\n            tenantId_slug: { tenantId: tenant.id, slug: courseSlug }\r\n        }\r\n    });\r\n    if (!course) notFound();\r\n\r\n    // Fetch Lesson + Previous/Next context logic could be added here\r\n    // Note: We need to filter by tenant/course implicitly via the module relations, \r\n    // or just fetch by slug and verify parentage.\r\n    // Simplest: FindFirst where slug = lessonSlug AND module.course.id = course.id\r\n    const lesson = await prisma.lesson.findFirst({\r\n        where: {\r\n            slug: lessonSlug,\r\n            module: {\r\n                courseId: course.id\r\n            }\r\n        }\r\n    });\r\n\r\n    if (!lesson) {\r\n        notFound();\r\n    }\r\n\r\n    // Helper function to embed videos\r\n    const getVideoEmbed = (url: string) => {\r\n        if (!url) return null;\r\n        if (url.includes('youtube.com') || url.includes('youtu.be')) {\r\n            const videoId = url.split('v=')[1] || url.split('/').pop();\r\n            return `https://www.youtube.com/embed/${videoId}`;\r\n        }\r\n        if (url.includes('vimeo')) {\r\n            const videoId = url.split('/').pop();\r\n            return `https://player.vimeo.com/video/${videoId}`;\r\n        }\r\n        return null;\r\n        // fallback for direct mp4?? No, let's assume iframe compatible for now.\r\n    }\r\n\r\n    const embedUrl = lesson.videoUrl ? getVideoEmbed(lesson.videoUrl) : null;\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-white dark:bg-black\">\r\n            {/* Video Player Area */}\r\n            {embedUrl ? (\r\n                <div className=\"w-full bg-black aspect-video\">\r\n                    <iframe\r\n                        src={embedUrl}\r\n                        className=\"w-full h-full\"\r\n                        allowFullScreen\r\n                        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n                    ></iframe>\r\n                </div>\r\n            ) : (\r\n                lesson.videoUrl && (\r\n                    <div className=\"w-full p-8 bg-gray-100 text-center\">\r\n                        <p>Video URL no soportada para embed simple: <a href={lesson.videoUrl} target=\"_blank\" className=\"underline text-blue-600\">{lesson.videoUrl}</a></p>\r\n                    </div>\r\n                )\r\n            )}\r\n\r\n            {/* Content Area */}\r\n            <div className=\"flex-1 p-8 max-w-4xl mx-auto w-full\">\r\n                <h1 className=\"text-3xl font-bold mb-6\">{lesson.title}</h1>\r\n\r\n                {lesson.content && (\r\n                    <div className=\"prose dark:prose-invert max-w-none\">\r\n                        {/* We should sanitize HTML if we were allowing rich text, but for admin-generated content, simple render is \"okay\" for MVP if we trust admin.\r\n                            Actually, we don't have a markdown parser installed yet. \r\n                            Let's assume content is plain text or simple HTML for now.\r\n                            For MVP, simple whitespace preservation.\r\n                        */}\r\n                        <div className=\"whitespace-pre-wrap font-sans text-gray-800 dark:text-gray-300\">\r\n                            {lesson.content}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;;;;AAEe,eAAe,WAAW,EACrC,MAAM,EAGT;IACG,MAAM,iBAAiB,MAAM;IAC7B,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG;IAEzC,MAAM,SAAS,MAAM,8HAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE;QAAK;IAAE;IAChE,IAAI,CAAC,QAAQ,IAAA,iMAAQ;IAErB,iCAAiC;IACjC,MAAM,SAAS,MAAM,8HAAM,CAAC,MAAM,CAAC,UAAU,CAAC;QAC1C,OAAO;YACH,eAAe;gBAAE,UAAU,OAAO,EAAE;gBAAE,MAAM;YAAW;QAC3D;IACJ;IACA,IAAI,CAAC,QAAQ,IAAA,iMAAQ;IAErB,iEAAiE;IACjE,iFAAiF;IACjF,8CAA8C;IAC9C,+EAA+E;IAC/E,MAAM,SAAS,MAAM,8HAAM,CAAC,MAAM,CAAC,SAAS,CAAC;QACzC,OAAO;YACH,MAAM;YACN,QAAQ;gBACJ,UAAU,OAAO,EAAE;YACvB;QACJ;IACJ;IAEA,IAAI,CAAC,QAAQ;QACT,IAAA,iMAAQ;IACZ;IAEA,kCAAkC;IAClC,MAAM,gBAAgB,CAAC;QACnB,IAAI,CAAC,KAAK,OAAO;QACjB,IAAI,IAAI,QAAQ,CAAC,kBAAkB,IAAI,QAAQ,CAAC,aAAa;YACzD,MAAM,UAAU,IAAI,KAAK,CAAC,KAAK,CAAC,EAAE,IAAI,IAAI,KAAK,CAAC,KAAK,GAAG;YACxD,OAAO,CAAC,8BAA8B,EAAE,SAAS;QACrD;QACA,IAAI,IAAI,QAAQ,CAAC,UAAU;YACvB,MAAM,UAAU,IAAI,KAAK,CAAC,KAAK,GAAG;YAClC,OAAO,CAAC,+BAA+B,EAAE,SAAS;QACtD;QACA,OAAO;IACP,wEAAwE;IAC5E;IAEA,MAAM,WAAW,OAAO,QAAQ,GAAG,cAAc,OAAO,QAAQ,IAAI;IAEpE,qBACI,8OAAC;QAAI,WAAU;;YAEV,yBACG,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBACG,KAAK;oBACL,WAAU;oBACV,eAAe;oBACf,OAAM;;;;;;;;;;uBAId,OAAO,QAAQ,kBACX,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;;wBAAE;sCAA0C,8OAAC;4BAAE,MAAM,OAAO,QAAQ;4BAAE,QAAO;4BAAS,WAAU;sCAA2B,OAAO,QAAQ;;;;;;;;;;;;;;;;;0BAMvJ,8OAAC;gBAAI,WAAU;;kCACX,8OAAC;wBAAG,WAAU;kCAA2B,OAAO,KAAK;;;;;;oBAEpD,OAAO,OAAO,kBACX,8OAAC;wBAAI,WAAU;kCAMX,cAAA,8OAAC;4BAAI,WAAU;sCACV,OAAO,OAAO;;;;;;;;;;;;;;;;;;;;;;;AAO3C"}}]
}