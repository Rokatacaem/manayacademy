module.exports=[90827,a=>{"use strict";var b=a.i(37936),c=a.i(66518),d=a.i(18558);a.i(70396);var e=a.i(73727);async function f(a,b){let f=b.get("email"),g=b.get("firstName"),h=b.get("lastName"),i=b.get("tags");if(!f)throw Error("Email is required");let j=i.split(",").map(a=>a.trim()).filter(Boolean);try{await c.prisma.contact.create({data:{tenantId:a,email:f,firstName:g,lastName:h,source:"Manual Entry",tags:{connectOrCreate:j.map(b=>({where:{tenantId_name:{name:b,tenantId:a}},create:{name:b,tenantId:a}}))}}})}catch(a){return console.error("Failed to create contact:",a),{error:"Failed to create contact. Email might already exist."}}(0,d.revalidatePath)("/admin/contacts"),(0,e.redirect)("/admin/contacts")}async function g(a,b,f){if(!b)return{error:"ID required"};let g=f.get("email"),h=f.get("firstName"),i=f.get("lastName"),j=f.get("tags"),k=f.get("status");if(!g)return{error:"Email is required"};let l=j.split(",").map(a=>a.trim()).filter(Boolean);try{let d=await c.prisma.contact.findUnique({where:{id:b}});if(!d||d.tenantId!==a)return{error:"Contact not found or access denied relative to tenant."};await c.prisma.contact.update({where:{id:b},data:{email:g,firstName:h,lastName:i,status:k,tags:{set:[],connectOrCreate:l.map(b=>({where:{tenantId_name:{name:b,tenantId:a}},create:{name:b,tenantId:a}}))}}})}catch(a){return console.error("Failed to update contact:",a),{error:"Failed to update contact."}}(0,d.revalidatePath)("/admin/contacts"),(0,d.revalidatePath)(`/admin/contacts/${b}`),(0,e.redirect)("/admin/contacts")}async function h(a,b){if(b){try{let d=await c.prisma.contact.findUnique({where:{id:b}});if(!d||d.tenantId!==a)return{error:"Access denied."};await c.prisma.contact.delete({where:{id:b}})}catch(a){return console.error("Failed to delete contact:",a),{error:"Failed to delete contact."}}(0,d.revalidatePath)("/admin/contacts"),(0,e.redirect)("/admin/contacts")}}async function i(a){let b=a.get("email"),d=a.get("firstName"),e=await c.prisma.tenant.findFirst();if(!e)return{error:"System not initialized. No tenant found."};if(!b)return{error:"Email is required"};try{return await c.prisma.contact.upsert({where:{tenantId_email:{email:b,tenantId:e.id}},update:{firstName:d},create:{tenantId:e.id,email:b,firstName:d,source:"Web/Landing"}}),{success:!0}}catch(a){return console.error("Failed to register lead:",a),{error:"Registration failed. Please try again."}}}(0,a.i(13095).ensureServerEntryExports)([f,g,h,i]),(0,b.registerServerReference)(f,"60a03e9cbcbc839e4ba63b7e761b7de8d556fdea2b",null),(0,b.registerServerReference)(g,"702ce05d86f183999eaa385b5b06b01655c070e46d",null),(0,b.registerServerReference)(h,"602dfe272af42807756d0c19eda457a545b8c630f9",null),(0,b.registerServerReference)(i,"402aa9aa5b1ca2439b0f58e3fd9240074f2f7baae7",null),a.s(["createContact",()=>f,"deleteContact",()=>h,"registerPublicLead",()=>i,"updateContact",()=>g])},42926,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(44721),e=a.i(54056),f=a.i(90827),g=a.i(66518);a.i(70396);var h=a.i(73727);let i=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60fdb9dcbac776ae459994d6cea1b77cdc5a4cef16",a);await c(b)};async function j({params:a}){let{slug:c}=await a,j=await g.prisma.tenant.findUnique({where:{slug:c}});j||(0,h.notFound)();let k=f.createContact.bind(null,j.id);return(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Nuevo Contacto"}),(0,b.jsxs)("form",{action:i.bind(null,(0,d.encryptActionBoundArgs)("60fdb9dcbac776ae459994d6cea1b77cdc5a4cef16",k)),className:"space-y-6 bg-white dark:bg-zinc-950 p-6 rounded-lg shadow border border-gray-200 dark:border-zinc-800",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nombre"}),(0,b.jsx)("input",{type:"text",name:"firstName",id:"firstName",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-transparent border"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Apellido"}),(0,b.jsx)("input",{type:"text",name:"lastName",id:"lastName",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-transparent border"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"email",name:"email",id:"email",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-transparent border"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Etiquetas (separadas por coma)"}),(0,b.jsx)("input",{type:"text",name:"tags",id:"tags",placeholder:"vip, nuevo, marzo2026",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 bg-transparent border"})]}),(0,b.jsx)("div",{className:"pt-4 flex justify-end",children:(0,b.jsx)(e.Button,{type:"submit",children:"Guardar Contacto"})})]})]})}(0,c.registerServerReference)(i,"60fdb9dcbac776ae459994d6cea1b77cdc5a4cef16",null),a.s(["$$RSC_SERVER_ACTION_0",0,i,"default",()=>j])},65952,a=>{"use strict";var b=a.i(57469),c=a.i(42926),d=a.i(90827);a.s([],85482),a.i(85482),a.s(["004eab34b3722ccdb34bdc153ae48c8c96bfc525ab",()=>b.$$RSC_SERVER_ACTION_0,"402aa9aa5b1ca2439b0f58e3fd9240074f2f7baae7",()=>d.registerPublicLead,"602dfe272af42807756d0c19eda457a545b8c630f9",()=>d.deleteContact,"60a03e9cbcbc839e4ba63b7e761b7de8d556fdea2b",()=>d.createContact,"60fdb9dcbac776ae459994d6cea1b77cdc5a4cef16",()=>c.$$RSC_SERVER_ACTION_0,"702ce05d86f183999eaa385b5b06b01655c070e46d",()=>d.updateContact],65952)}];

//# sourceMappingURL=_743e2775._.js.map