{"version":3,"sources":["../../../../src/components/RichEditor.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useRef, useState } from 'react'\r\n\r\ninterface RichEditorProps {\r\n    name: string\r\n    initialValue?: string\r\n}\r\n\r\nfunction loadScript(src: string): Promise<void> {\r\n    return new Promise((resolve, reject) => {\r\n        if (document.querySelector(`script[src=\"${src}\"]`)) {\r\n            resolve(); return;\r\n        }\r\n        const s = document.createElement('script')\r\n        s.src = src\r\n        s.onload = () => resolve()\r\n        s.onerror = reject\r\n        document.head.appendChild(s)\r\n    })\r\n}\r\n\r\nfunction loadCss(href: string) {\r\n    if (document.querySelector(`link[href=\"${href}\"]`)) return\r\n    const l = document.createElement('link')\r\n    l.rel = 'stylesheet'\r\n    l.href = href\r\n    document.head.appendChild(l)\r\n}\r\n\r\nexport default function RichEditor({ name, initialValue = '' }: RichEditorProps) {\r\n    const containerRef = useRef<HTMLDivElement>(null)\r\n    const quillRef = useRef<any>(null)\r\n    const [htmlValue, setHtmlValue] = useState(initialValue)\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        let cancelled = false\r\n\r\n        async function init() {\r\n            loadCss('https://cdn.quilljs.com/1.3.7/quill.snow.css')\r\n            await loadScript('https://cdn.quilljs.com/1.3.7/quill.min.js')\r\n\r\n            if (cancelled || !containerRef.current || quillRef.current) return\r\n\r\n            const QuillLib = (window as any).Quill\r\n            const Quill = QuillLib?.default ?? QuillLib\r\n            quillRef.current = new Quill(containerRef.current, {\r\n                theme: 'snow',\r\n                placeholder: 'Escribe tu mensaje aquí. Puedes insertar imágenes, cambiar colores, añadir enlaces y mucho más...',\r\n                modules: {\r\n                    toolbar: [\r\n                        [{ header: [1, 2, 3, false] }],\r\n                        ['bold', 'italic', 'underline', 'strike'],\r\n                        [{ color: [] }, { background: [] }],\r\n                        [{ font: [] }],\r\n                        [{ align: [] }],\r\n                        ['blockquote'],\r\n                        [{ list: 'ordered' }, { list: 'bullet' }],\r\n                        ['link', 'image', 'video'],\r\n                        ['clean'],\r\n                    ],\r\n                    clipboard: { matchVisual: false },\r\n                },\r\n            })\r\n\r\n            if (initialValue) {\r\n                quillRef.current.clipboard.dangerouslyPasteHTML(initialValue)\r\n            }\r\n\r\n            quillRef.current.on('text-change', () => {\r\n                const html = quillRef.current.root.innerHTML\r\n                setHtmlValue(html === '<p><br></p>' ? '' : html)\r\n            })\r\n\r\n            if (!cancelled) setLoading(false)\r\n        }\r\n\r\n        init().catch(console.error)\r\n\r\n        return () => { cancelled = true }\r\n    }, []) // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    return (\r\n        <div>\r\n            <input type=\"hidden\" name={name} value={htmlValue} />\r\n\r\n            {loading && (\r\n                <div style={{ padding: '40px', textAlign: 'center', color: '#94a3b8', fontSize: '0.85rem', background: '#f8fafc', borderRadius: '12px', border: '1px solid #f1f5f9' }}>\r\n                    Cargando editor...\r\n                </div>\r\n            )}\r\n\r\n            <div style={{ display: loading ? 'none' : 'block', border: '1px solid #e2e8f0', borderRadius: '12px', overflow: 'hidden', background: 'white' }}>\r\n                <div ref={containerRef} style={{ minHeight: '420px', fontSize: '1rem' }} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}