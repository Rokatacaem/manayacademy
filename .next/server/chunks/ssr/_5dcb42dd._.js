module.exports=[20122,a=>{"use strict";var b=a.i(37936),c=a.i(66518),d=a.i(18558);a.i(70396);var e=a.i(73727);async function f(a,b,f,g){let h=g.get("title"),i=g.get("slug"),j=g.get("videoUrl"),k=g.get("content");if(!h||!i)return{error:"Title and Slug required"};try{let b=await c.prisma.module.findUnique({where:{id:f}});if(!b||b.tenantId!==a)return{error:"Access denied"};let d=await c.prisma.lesson.findFirst({where:{moduleId:f},orderBy:{order:"desc"}}),e=(d?.order??-1)+1;await c.prisma.lesson.create({data:{tenantId:a,moduleId:f,title:h,slug:i,videoUrl:j,content:k,order:e}})}catch(a){return console.error("Create Lesson Error:",a),{error:"Failed to create lesson"}}(0,d.revalidatePath)(`/admin/courses/${b}`),(0,e.redirect)(`/admin/courses/${b}`)}async function g(a,b,f,g,h){let i=h.get("title"),j=h.get("slug"),k=h.get("videoUrl"),l=h.get("content");try{let b=await c.prisma.lesson.findUnique({where:{id:g}});if(!b||b.tenantId!==a)return{error:"Access denied"};await c.prisma.lesson.update({where:{id:g},data:{title:i,slug:j,videoUrl:k,content:l}})}catch(a){return{error:"Update failed"}}(0,d.revalidatePath)(`/admin/courses/${b}`),(0,d.revalidatePath)(`/admin/courses/${b}/modules/${f}/lessons/${g}`),(0,e.redirect)(`/admin/courses/${b}`)}async function h(a,b,e){try{let b=await c.prisma.lesson.findUnique({where:{id:e}});if(!b||b.tenantId!==a)return{error:"Access denied"};await c.prisma.lesson.delete({where:{id:e}})}catch(a){return{error:"Delete failed"}}(0,d.revalidatePath)(`/admin/courses/${b}`)}(0,a.i(13095).ensureServerEntryExports)([f,g,h]),(0,b.registerServerReference)(f,"78fbd6c6427b76f39c03d6f5b06f73afc53afa017d",null),(0,b.registerServerReference)(g,"7c9e36c959a1e5098b6f32a5cbd0778c0f00e3555a",null),(0,b.registerServerReference)(h,"70bab27e667a2a26e8f7c191d43e563faf5bd79c44",null),a.s(["createLesson",()=>f,"deleteLesson",()=>h,"updateLesson",()=>g])},46347,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(44721),e=a.i(66518),f=a.i(54056),g=a.i(20122);a.i(70396);var h=a.i(73727);let i=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60d433782de7a40b0ab44970979b32ac4bf9043d09",a);await c(b)};(0,c.registerServerReference)(i,"60d433782de7a40b0ab44970979b32ac4bf9043d09",null);let j=async function(a){var[b]=await (0,d.decryptActionBoundArgs)("40f70e4a02cc864685ff720d829fb4b40ced5eb979",a);await b()};async function k({params:a}){let{slug:c,courseId:k,moduleId:l,lessonId:m}=await a,n=await e.prisma.tenant.findUnique({where:{slug:c}});n||(0,h.notFound)();let o=await e.prisma.lesson.findUnique({where:{id:m},include:{module:!0}});o&&o.tenantId===n.id&&o.moduleId===l&&o.module.courseId===k||(0,h.notFound)();let p=g.updateLesson.bind(null,n.id,k,l,m),q=g.deleteLesson.bind(null,n.id,k,m);return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold",children:["Editar Lección: ",o.title]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,b.jsx)("div",{className:"md:col-span-2 space-y-6",children:(0,b.jsxs)("form",{action:i.bind(null,(0,d.encryptActionBoundArgs)("60d433782de7a40b0ab44970979b32ac4bf9043d09",p)),className:"bg-white dark:bg-zinc-950 p-6 rounded-lg shadow border border-gray-200 dark:border-zinc-800 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Título"}),(0,b.jsx)("input",{type:"text",name:"title",defaultValue:o.title,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm p-2 bg-transparent border"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Slug (URL)"}),(0,b.jsx)("input",{type:"text",name:"slug",defaultValue:o.slug,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm p-2 bg-transparent border"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"videoUrl",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Video URL"}),(0,b.jsx)("input",{type:"text",name:"videoUrl",defaultValue:o.videoUrl||"",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm p-2 bg-transparent border"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Contenido"}),(0,b.jsx)("textarea",{name:"content",rows:10,defaultValue:o.content||"",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-zinc-700 shadow-sm p-2 bg-transparent border font-mono"})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4",children:(0,b.jsx)(f.Button,{type:"submit",children:"Guardar Cambios"})})]})}),(0,b.jsx)("div",{className:"md:col-span-1 space-y-6",children:(0,b.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 p-6 rounded-lg border border-red-200 dark:border-red-900",children:[(0,b.jsx)("h3",{className:"text-sm font-bold text-red-800 dark:text-red-300 mb-2",children:"Zona de Peligro"}),(0,b.jsx)("form",{action:j.bind(null,(0,d.encryptActionBoundArgs)("40f70e4a02cc864685ff720d829fb4b40ced5eb979",q)),children:(0,b.jsx)(f.Button,{type:"submit",variant:"destructive",className:"w-full",children:"Eliminar Lección"})})]})})]})]})}(0,c.registerServerReference)(j,"40f70e4a02cc864685ff720d829fb4b40ced5eb979",null),a.s(["$$RSC_SERVER_ACTION_0",0,i,"$$RSC_SERVER_ACTION_1",0,j,"default",()=>k])},91223,a=>{"use strict";var b=a.i(57469),c=a.i(46347),d=a.i(20122);a.s([],35017),a.i(35017),a.s(["004eab34b3722ccdb34bdc153ae48c8c96bfc525ab",()=>b.$$RSC_SERVER_ACTION_0,"40f70e4a02cc864685ff720d829fb4b40ced5eb979",()=>c.$$RSC_SERVER_ACTION_1,"60d433782de7a40b0ab44970979b32ac4bf9043d09",()=>c.$$RSC_SERVER_ACTION_0,"70bab27e667a2a26e8f7c191d43e563faf5bd79c44",()=>d.deleteLesson,"78fbd6c6427b76f39c03d6f5b06f73afc53afa017d",()=>d.createLesson,"7c9e36c959a1e5098b6f32a5cbd0778c0f00e3555a",()=>d.updateLesson],91223)}];

//# sourceMappingURL=_5dcb42dd._.js.map