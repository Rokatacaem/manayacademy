module.exports=[13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},58146,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getClientReferenceManifest:function(){return q},getServerActionsManifest:function(){return r},getServerModuleMap:function(){return s},selectWorkerForForwarding:function(){return n},setManifestsSingleton:function(){return o}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(50640),g=a.r(5847),h=a.r(39481),i=a.r(61601),j=a.r(56704),k=Symbol.for("next.server.manifests"),l=globalThis;function m(a){return(0,h.pathHasPrefix)(a,"app")?a:"app"+a}function n(a,b){var c,d;let e=null==(c=r().node[a])?void 0:c.workers;if(e&&!e[m(b)])return d=Object.keys(e)[0],(0,g.normalizeAppPath)((0,i.removePathPrefix)(d,"app"))}function o({page:a,clientReferenceManifest:b,serverActionsManifest:c}){let d=l[k];if(d)d.clientReferenceManifestsPerRoute.set((0,g.normalizeAppPath)(a),b),d.serverActionsManifest=c;else{let d,e=new Map([[(0,g.normalizeAppPath)(a),b]]),h=(d=new Map,new Proxy({},{get(a,b){let c=j.workAsyncStorage.getStore();switch(b){case"moduleLoading":case"entryCSSFiles":case"entryJSFiles":{if(!c)throw Object.defineProperty(new f.InvariantError(`Cannot access "${b}" without a work store.`),"__NEXT_ERROR_CODE",{value:"E952",enumerable:!1,configurable:!0});let a=e.get(c.route);if(!a)throw Object.defineProperty(new f.InvariantError(`The client reference manifest for route "${c.route}" does not exist.`),"__NEXT_ERROR_CODE",{value:"E951",enumerable:!1,configurable:!0});return a[b]}case"clientModules":case"rscModuleMapping":case"edgeRscModuleMapping":case"ssrModuleMapping":case"edgeSSRModuleMapping":{let a=d.get(b);!a&&(a=new Proxy({},{get(a,c){let d=j.workAsyncStorage.getStore();if(d){let a=e.get(d.route);if(null==a?void 0:a[b][c])return a[b][c]}else for(let a of e.values()){let d=a[b][c];if(void 0!==d)return d}}}),d.set(b,a));return a}default:throw Object.defineProperty(new f.InvariantError(`This is a proxied client reference manifest. The property "${String(b)}" is not handled.`),"__NEXT_ERROR_CODE",{value:"E953",enumerable:!1,configurable:!0})}}}));l[k]={clientReferenceManifestsPerRoute:e,proxiedClientReferenceManifest:h,serverActionsManifest:c,serverModuleMap:new Proxy({},{get:(a,b)=>{var c,d;let e,f=null==(d=r().node)||null==(c=d[b])?void 0:c.workers;if(!f)return;let g=j.workAsyncStorage.getStore();if(!(e=g?f[m(g.page)]:Object.values(f).at(0)))return;let{moduleId:h,async:i}=e;return{id:h,name:b,chunks:[],async:i}}})}}}function p(){let a=l[k];if(!a)throw Object.defineProperty(new f.InvariantError("The manifests singleton was not initialized."),"__NEXT_ERROR_CODE",{value:"E950",enumerable:!1,configurable:!0});return a}function q(){return p().proxiedClientReferenceManifest}function r(){return p().serverActionsManifest}function s(){return p().serverModuleMap}},49126,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0});var e={arrayBufferToString:function(){return i},decrypt:function(){return l},encrypt:function(){return k},getActionEncryptionKey:function(){return m},stringToUint8Array:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(50640),h=a.r(58146);function i(a){let b=new Uint8Array(a),c=b.byteLength;if(c<65535)return String.fromCharCode.apply(null,b);let d="";for(let a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}function j(a){let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function k(a,b,c){return crypto.subtle.encrypt({name:"AES-GCM",iv:b},a,c)}function l(a,b,c){return crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c)}async function m(){if(d)return d;let a=(0,h.getServerActionsManifest)(),b=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||a.encryptionKey;if(void 0===b)throw Object.defineProperty(new g.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return d=await crypto.subtle.importKey("raw",j(atob(b)),"AES-GCM",!0,["encrypt","decrypt"])}},44721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={decryptActionBoundArgs:function(){return x},encryptActionBoundArgs:function(){return w}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});a.r(55781);let h=a.r(11857),i=a.r(35427),j=a.r(75406),k=a.r(49126),l=a.r(58146),m=a.r(32319),n=a.r(60384),o=(d=a.r(717))&&d.__esModule?d:{default:d},p=new TextEncoder,q=new TextDecoder,r,s;async function t(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),g=q.decode(await (0,k.decrypt)(c,(0,k.stringToUint8Array)(e),(0,k.stringToUint8Array)(f)));if(!g.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return g.slice(a.length)}async function u(a,b){let c=await (0,k.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);m.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,k.arrayBufferToString)(d.buffer),f=await (0,k.encrypt)(c,d,p.encode(a+b));return btoa(e+(0,k.arrayBufferToString)(f))}var v=((e=v||{})[e.Ready=0]="Ready",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete",e);let w=o.default.cache(async function a(b,...c){let d=m.workUnitAsyncStorage.getStore(),e=d?(0,m.getCacheSignal)(d):void 0,{clientModules:f}=(0,l.getClientReferenceManifest)(),g=Error();Error.captureStackTrace(g,a);let i=!1,k=d?(0,n.createHangingInputAbortSignal)(d):void 0,o=0;function p(){0===o&&(o=1,null==e||e.beginRead())}function q(){1===o&&(null==e||e.endRead()),o=2}k&&e&&k.addEventListener("abort",p,{once:!0});let s=await (0,j.streamToString)((0,h.renderToReadableStream)(c,f,{filterStackFrame:r,signal:k,onError(a){(null==k?void 0:k.aborted)||i||(i=!0,g.message=a instanceof Error?a.message:String(a))}}),k);if(i)throw q(),g;if(!d)return u(b,s);p();let t=(0,m.getPrerenderResumeDataCache)(d),v=(0,m.getRenderResumeDataCache)(d),w=b+s,x=(null==t?void 0:t.encryptedBoundArgs.get(w))??(null==v?void 0:v.encryptedBoundArgs.get(w));if(x)return x;let y=await u(b,s);return q(),null==t||t.encryptedBoundArgs.set(w,y),y});async function x(a,b){let c,d=await b,e=m.workUnitAsyncStorage.getStore();if(e){let b=(0,m.getCacheSignal)(e),f=(0,m.getPrerenderResumeDataCache)(e),g=(0,m.getRenderResumeDataCache)(e);(c=(null==f?void 0:f.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await t(a,d),null==b||b.endRead(),null==f||f.decryptedBoundArgs.set(d,c))}else c=await t(a,d);let{edgeRscModuleMapping:f,rscModuleMapping:g}=(0,l.getClientReferenceManifest)();return await (0,i.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(p.encode(c)),null==e?void 0:e.type){case"prerender":case"prerender-runtime":e.renderSignal.aborted?a.close():e.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:s,serverConsumerManifest:{moduleLoading:null,moduleMap:g,serverModuleMap:(0,l.getServerModuleMap)()}})}},99453,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/TestEmailPanel.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/TestEmailPanel.tsx <module evaluation>","default")},28635,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/TestEmailPanel.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/TestEmailPanel.tsx","default")},84737,a=>{"use strict";a.i(99453);var b=a.i(28635);a.n(b)},9210,a=>{"use strict";var b=a.i(7997),c=a.i(37936),d=a.i(44721),e=a.i(66518),f=a.i(54400);a.i(70396);var g=a.i(73727),h=a.i(84737),i=a.i(25010),j=a.i(95936);let k=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60b5fafefb9ba82b821fe9072158198870df771f8e",a);await c(b)};(0,c.registerServerReference)(k,"60b5fafefb9ba82b821fe9072158198870df771f8e",null);let l=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("60e33d8b1d7c737629fd3d25c93be088e33dc6a85a",a);await c(b)};(0,c.registerServerReference)(l,"60e33d8b1d7c737629fd3d25c93be088e33dc6a85a",null);let m=async function(a,b){var[c]=await (0,d.decryptActionBoundArgs)("602a9281b735c54d76365788fede4d611303a7e81c",a);await c(b)};async function n({params:a}){let{slug:c,id:n}=await a,o=await e.prisma.tenant.findUnique({where:{slug:c}});o||(0,g.notFound)();let p=await e.prisma.campaign.findUnique({where:{id:n}});p&&p.tenantId===o.id||(0,g.notFound)();let q=await e.prisma.tag.findMany({where:{tenantId:o.id},orderBy:{name:"asc"}}),r="SENT"===p.status,s=p.stats,t=f.updateCampaign.bind(null,o.id,p.id),u=f.deleteCampaign.bind(null,o.id,p.id),v=f.sendCampaign.bind(null,o.id,p.id),w=k.bind(null,(0,d.encryptActionBoundArgs)("60b5fafefb9ba82b821fe9072158198870df771f8e",t)),x=l.bind(null,(0,d.encryptActionBoundArgs)("60e33d8b1d7c737629fd3d25c93be088e33dc6a85a",u)),y=m.bind(null,(0,d.encryptActionBoundArgs)("602a9281b735c54d76365788fede4d611303a7e81c",v)),z=r?"#bbf7d0":"#fde68a";return(0,b.jsxs)("div",{style:{maxWidth:"1100px"},children:[(0,b.jsxs)("div",{style:{marginBottom:"40px",display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{style:{fontSize:"0.7rem",color:"#7c9082",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.3em",marginBottom:"8px"},children:"Marketing"}),(0,b.jsx)("h1",{style:{fontSize:"1.8rem",color:"#2c3e50",margin:"0 0 12px",fontWeight:"400"},children:r?"Informe de CampaÃ±a":"Editar CampaÃ±a"}),(0,b.jsx)("span",{style:{display:"inline-block",padding:"6px 16px",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.15em",background:r?"#f0fdf4":"#fffbeb",color:r?"#166534":"#92400e",border:`1px solid ${z}`},children:r?"âœ… Enviada":"ðŸ“ Borrador"})]}),(0,b.jsx)(j.default,{href:"/admin/campaigns",style:{fontSize:"0.75rem",color:"#64748b",textDecoration:"none",fontWeight:"600"},children:"â† Volver a campaÃ±as"})]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:"32px",alignItems:"start"},children:[(0,b.jsx)("div",{children:(0,b.jsx)("form",{action:w,children:(0,b.jsxs)("fieldset",{disabled:r,style:{border:"none",padding:0,margin:0},children:[(0,b.jsxs)("div",{style:{background:"white",padding:"30px",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0,0,0,0.04)",marginBottom:"24px"},children:[(0,b.jsx)("label",{style:{fontSize:"0.65rem",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.2em",display:"block",marginBottom:"12px"},children:"Asunto"}),(0,b.jsx)("input",{type:"text",name:"subject",defaultValue:p.subject,style:{width:"100%",padding:"16px",border:"1px solid #f1f5f9",borderRadius:"12px",fontSize:"1.1rem",background:"#f8fafc",boxSizing:"border-box",color:"#2c3e50"}})]}),(0,b.jsxs)("div",{style:{background:"white",padding:"30px",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0,0,0,0.04)",marginBottom:"24px"},children:[(0,b.jsx)("label",{style:{fontSize:"0.65rem",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.2em",display:"block",marginBottom:"16px"},children:"Contenido del Mensaje"}),r?(0,b.jsx)("div",{style:{padding:"20px",background:"#faf9f6",borderRadius:"12px",border:"1px solid #f1f5f9",minHeight:"200px"},dangerouslySetInnerHTML:{__html:p.content||""}}):(0,b.jsx)(i.default,{name:"content",initialValue:p.content||""})]}),!r&&(0,b.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,b.jsx)("button",{type:"submit",style:{padding:"14px 32px",background:"#5e6f63",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"700",fontSize:"0.8rem",textTransform:"uppercase",letterSpacing:"0.15em"},children:"Guardar Cambios"})})]})})}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,b.jsx)(h.default,{tenantId:o.id,campaignId:p.id,defaultEmail:"info@manayacademy.com"}),r?(0,b.jsxs)("div",{style:{background:"white",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0,0,0,0.04)",padding:"24px"},children:[(0,b.jsx)("h3",{style:{margin:"0 0 20px",fontSize:"1rem",color:"#2c3e50"},children:"ðŸ“Š Resultados"}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"14px",background:"#f0fdf4",borderRadius:"12px"},children:[(0,b.jsx)("span",{style:{fontSize:"0.85rem",color:"#166534"},children:"âœ… Enviados"}),(0,b.jsx)("strong",{style:{color:"#166534"},children:s?.sent??0})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"14px",background:"#fef2f2",borderRadius:"12px"},children:[(0,b.jsx)("span",{style:{fontSize:"0.85rem",color:"#991b1b"},children:"âŒ Errores"}),(0,b.jsx)("strong",{style:{color:"#991b1b"},children:s?.errors??0})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"14px",background:"#f8fafc",borderRadius:"12px"},children:[(0,b.jsx)("span",{style:{fontSize:"0.85rem",color:"#2c3e50"},children:"ðŸ‘¥ Total"}),(0,b.jsx)("strong",{children:s?.total??0})]})]})]}):(0,b.jsxs)("div",{style:{background:"white",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0,0,0,0.04)",overflow:"hidden"},children:[(0,b.jsxs)("div",{style:{background:"linear-gradient(135deg, #2c3e50, #1a252f)",padding:"20px 24px"},children:[(0,b.jsx)("p",{style:{margin:0,color:"rgba(255,255,255,0.6)",fontSize:"0.65rem",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.3em"},children:"EnvÃ­o masivo"}),(0,b.jsx)("h3",{style:{margin:"4px 0 0",color:"white",fontSize:"1rem",fontWeight:"600"},children:"ðŸš€ Lanzar CampaÃ±a"})]}),(0,b.jsxs)("div",{style:{padding:"24px"},children:[(0,b.jsxs)("p",{style:{fontSize:"0.78rem",color:"#64748b",marginBottom:"16px"},children:["âš ï¸ Una vez enviada, ",(0,b.jsx)("strong",{children:"no podrÃ¡s editar"})," esta campaÃ±a. AsegÃºrate de haberla probado antes."]}),(0,b.jsxs)("form",{action:y,children:[(0,b.jsx)("label",{style:{fontSize:"0.65rem",fontWeight:"700",color:"#94a3b8",textTransform:"uppercase",letterSpacing:"0.15em",display:"block",marginBottom:"8px"},children:"Destinatarios"}),(0,b.jsxs)("select",{name:"targetType",style:{width:"100%",padding:"12px",border:"1px solid #e2e8f0",borderRadius:"10px",marginBottom:"16px",background:"#f8fafc",fontSize:"0.85rem",color:"#2c3e50"},children:[(0,b.jsx)("option",{value:"all",children:"Todos los Contactos Activos"}),(0,b.jsx)("option",{value:"tags",children:"Filtrar por Etiquetas"})]}),q.length>0&&(0,b.jsxs)("div",{style:{maxHeight:"160px",overflowY:"auto",border:"1px solid #e2e8f0",borderRadius:"10px",padding:"12px",marginBottom:"16px"},children:[(0,b.jsx)("p",{style:{fontSize:"0.7rem",color:"#94a3b8",margin:"0 0 10px",fontWeight:"600"},children:"Selecciona etiquetas:"}),q.map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"4px 0",fontSize:"0.85rem",color:"#2c3e50",cursor:"pointer"},children:[(0,b.jsx)("input",{type:"checkbox",name:"tags",value:a.id}),a.name]},a.id))]}),(0,b.jsx)("button",{type:"submit",style:{width:"100%",padding:"16px",background:"#2c3e50",color:"white",border:"none",borderRadius:"12px",cursor:"pointer",fontWeight:"700",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.15em"},children:"Enviar Ahora ðŸš€"})]})]})]}),(0,b.jsx)("form",{action:x,children:(0,b.jsx)("button",{type:"submit",style:{width:"100%",padding:"12px",background:"none",border:"1px solid #fecaca",color:"#ef4444",borderRadius:"12px",cursor:"pointer",fontWeight:"600",fontSize:"0.75rem"},children:"ðŸ—‘ï¸ Eliminar campaÃ±a"})})]})]})]})}(0,c.registerServerReference)(m,"602a9281b735c54d76365788fede4d611303a7e81c",null),a.s(["$$RSC_SERVER_ACTION_0",0,k,"$$RSC_SERVER_ACTION_1",0,l,"$$RSC_SERVER_ACTION_2",0,m,"default",()=>n])},41831,a=>{"use strict";var b=a.i(57469),c=a.i(9210),d=a.i(54400);a.s([],75221),a.i(75221),a.s(["004eab34b3722ccdb34bdc153ae48c8c96bfc525ab",()=>b.$$RSC_SERVER_ACTION_0,"602a9281b735c54d76365788fede4d611303a7e81c",()=>c.$$RSC_SERVER_ACTION_2,"60b5fafefb9ba82b821fe9072158198870df771f8e",()=>c.$$RSC_SERVER_ACTION_0,"60b65e72b3e35b33840f299682e69ec9d754c4da2a",()=>d.createCampaign,"60e33d8b1d7c737629fd3d25c93be088e33dc6a85a",()=>c.$$RSC_SERVER_ACTION_1,"701408ee420927c632a36e834d4582ccea0b0b4f2e",()=>d.deleteCampaign,"709c08b87bbb42dbecee8b10a6cfb1bab4369bee79",()=>d.sendCampaign,"70c6a5394d4e2aaae04d1f4ae2e9256dc917c008d2",()=>d.sendTestEmail,"70d18c92ed0450fa61798ee749bae403adc72a5422",()=>d.updateCampaign],41831)}];

//# sourceMappingURL=_1d702f2b._.js.map